process_varnames <- function(gp, nx) {
	
	varnames <- c("by", "fill", "bubble.size", "bubble.col", "line.col", "line.lwd")
	
	varnamesList <- lapply(gp, function(x) x$varnames)
	
	vars <- lapply(varnames, function(v) lapply(varnamesList, function(x) x[[v]]))
	names(vars) <- varnames
	
	vars2 <- lapply(vars, function(v) {
		id <- which(sapply(v, function(x)!is.na(x[1])))
		if (length(id)) rep(v[[id[1]]], length.out=nx) else NA
	})
	
	names(vars2) <- varnames
	vars2
}
